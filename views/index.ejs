<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Macsoft | Call Status</title>
  
  <link rel="icon" href="/images/logo1.png" >
  <!-- <link rel="stylesheet" href="/css/style.css"> -->

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.datatables.net/2.0.8/css/dataTables.bootstrap5.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

</head>

<body>

  


  <nav class="navbar bg-light p-4 shadow">
    <div class="container-fluid ">
      <a class="navbar-brand " href="#" style="font-size: 2rem; font-weight: 600;">
        <img src="/images/image.png" alt="Logo" width="50" height="44" class="d-inline-block align-text-top">
        <span style="color: rgb(0, 187, 255);">MAC</span><span style="color:rgb(7, 7, 7);">S</span><span
          style="color: rgb(250, 14, 14);">OFT</span>
      </a>
      <button type="button" class="btn btn-primary rounded-pill text-center fw-bold" data-bs-toggle="modal" data-bs-target="#exampleModal"
        data-bs-whatever="@mdo"> <i class="fa-solid fa-phone"></i> </button> 
        <div>
          <button class="btn btn-primary rounded-pill text-center fw-bold "><%= openCalls %> / <%= totalCalls %></button>
        </div>
    </div>
    
  </nav>


  
    



  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" >
      <div class="modal-content" id="call">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Add_Call</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" >
          <form method="post"  id="userform" enctype="multipart/form-data">
            <div class="row">
              <div class="col">
                <div class="mb-3">
                  <label for="recipient-name" class="col-form-label">Company :</label>
                  <select class="form-select" aria-label="Default select example" name="company" id="recipient-name">
                    <option value="CRI">CRI</option>
                    <option value="KSB">KSB</option>
                    <option value="PSG">PSG</option>
                    <option value="PRIVATE">PRIVATE</option>
                  </select>
                </div>
              </div>

              <div class="col">
                <div class="mb-3">
                  <label for="recipient-name" class="col-form-label">Phone :</label>
                  <input type="number" class="form-control" id="recipient-name" name="phone" required>
                </div>
              </div>
            </div>

            <div class="mb-3">
              <label for="recipient-name" class="col-form-label">ControllerNo :</label>
              <input type="text" class="form-control" id="recipient-name" name="controllerno" required>
            </div>


            <div class="row">
              <div class="col">
                <div class="mb-3">
                  <label for="recipient-name" class="col-form-label">Date :</label>
                  <input type="date" class="form-control" id="recipient-name" name="date"  required>
                </div>
              </div>
              <div class="col">
                <div class="mb-3">
                  <label for="recipient-name" class="col-form-label">State :</label>
                  <input type="text" class="form-control" id="recipient-name" name="state" required>
                </div>
              </div>
            </div>


            <div class="row">
              <div class="col">
                <div class="mb-3">
                  <label for="recipient-name" class="col-form-label">Item :</label>
                  <select class="form-select" aria-label="Default select example" name="productname"
                    id="recipient-name">
                    <optgroup label="AC">
                      <option value="1-HP-AC">1-HP-AC</option>
                      <option value="2-HP-AC">2-HP-AC</option>
                      <option value="3-HP-AC">3-HP-AC</option>
                      <option value="5-HP-AC">5-HP-AC</option>
                      <option value="7.5-HP-AC">7.5-HP-AC</option>
                      <option value="10-HP-AC">10-HP-AC</option>
                    </optgroup>
                    <optgroup label="DC">
                      <option value="1-HP-DC">1-HP-DC</option>
                      <option value="2-HP-DC">2-HP-DC</option>
                      <option value="3-HP-DC">3-HP-DC</option>
                      <option value="5-HP-DC">5-HP-DC</option>
                      <option value="7.5-HP-DC">7.5-HP-DC</option>
                      <option value="10-HP-DC">10-HP-DC</option>
                    </optgroup>
                    <OPtion value="Others">Others</OPtion>
                  </select>
                </div>
              </div>

              <div class="col">
                <div class="mb-3">
                  <label for="recipient-name" class="col-form-label">Item-Type :</label>
                  <select class="form-select" aria-label="Default select example" name="itemtype" id="recipient-name">
                    <option value="Sub">Sub</option>
                    <option value="Surface">Surface</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="mb-3">
              <label for="recipient-name" class="col-form-label">Issue :</label>
              <!-- <input type="text" class="form-control" id="recipient-name" name="issue" required> -->
              <textarea class="form-control" id="exampleFormControlTextarea1" name="issue" rows="3"></textarea>
            </div>
            <div class="mb-3">
              <label for="solution" class="col-form-label">Solution :</label>
              <!-- <input type="text" class="form-control" id="solution" name="solution" required> -->
              <textarea class="form-control" id="exampleFormControlTextarea1" name="solution" rows="3"></textarea>
            </div>

            <div class="row">
              <div class="col">
                <div class="mb-3">
                  <label for="attachment" class="col-form-label">Attachment :</label>
                  <input class="form-control" type="file" id="attachment" name="attachment">
                </div>
              </div>
              <div class="col">
                <div class="mb-3">
                  <label for="recipient-name" class="col-form-label">Status :</label>
                  <select class="form-select" aria-label="Default select example" name="status">
                    <option value="Open" class="open">Open</option>
                    <option value="Closed" class="closed">Closed</option>
                  </select>
                </div>
              </div>
            </div>

          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="user-form-submit">submit</button>
        </div>
      </div>
    </div>
  </div>
 
  <div class="modal-body">
  <div class="table-responsive p-4">
    <div style="max-height: 100%;overflow-y:auto ;">
    <table id="example" class="table table-striped " style="width:100%">
      <thead class="table-light ">
        <tr>
          <!-- <th>CustomerID</th>  -->
          <th>Company</th>
          <th>PhoneNo</th>
          <th>ControllerNo</th>
          <th>Date</th>
          <th>Item</th>
          <th>Item-Type</th>
          <th>State</th>
          <th>Issue</th>
          <th>Solution</th>
          <th>Status</th>
           <th>Attachment</th> 
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <% db.forEach((value)=>{ %>
          <tr class="text-start">
            <!-- <td><%= value.customerid %></td> -->
            <td>
              <%= value.company %>
            </td>
            <td>
              <%= value.phone %>
            </td>
            <td>
              <%= value.controllerno %>
            </td>
            <td>
              <%= value.date %>
            </td>
            <td>
              <%= value.productname %>
            </td>
            <td>
              <%= value.itemtype %>
            </td>
            <td>
              <%= value.state %>
            </td>
            <td>
              <%= value.issue %>
            </td>
            <td>
              <% let solutions=value.solution.split(",") %>
                <ol>
                  <% solutions.forEach((solution, index)=> { %>
                    <li>
                      <%= solution.trim() %>
                    </li>
                    <% }) %>
                </ol>
            </td>

            <% if(value.status==='Open' ){ %>
              <td style="color:green;font-weight: bold;">
                <%= value.status %>
                  <!-- <i class="fa-solid fa-check"></i> -->
              </td>
              <% }else{%>
                <td style="color:red;font-weight:600;">
                  <%= value.status %>
                    <!-- <i class="fa-solid fa-xmark"></i> -->
                </td>
                <%} %>
                <td><img src="/upload/<%= value.attachment %>" alt="Attachment" style="width:100px;height:auto;"></td> 

                  <td>
                    <button type="button" class="btn btn-no-outline"><a style="color:blue;"
                        href="/edit/<%= value.controllerno %>"><i class="fa-solid fa-pen-to-square"></i></a> </button>
                    <button type="button" class="btn btn-no-outline"><a style="color: rgb(246, 10, 10); text-decoration: none;"
                        href="/delete/<%= value.controllerno %>" class="delete"><i
                          class="fa-solid fa-trash"></i></a></button>
                  </td>
          </tr>
          <% }) %>

      </tbody>
    </table>
  </div>
</div>
</div>


  <script src="https://code.jquery.com/jquery-3.7.1.min.js"
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <script src="https://cdn.datatables.net/2.0.7/js/dataTables.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.datatables.net/2.0.8/js/dataTables.js"></script>
  <script src="https://cdn.datatables.net/2.0.8/js/dataTables.bootstrap5.js"></script>
  <script>
    new DataTable('#example');


    // code for form submit 
    var userform = document.getElementById('userform')
    var userformsubmit = document.getElementById('user-form-submit')
    var solution = document.getElementById('solution')
    userformsubmit.addEventListener('click', (event) => {
      event.preventDefault()
      userform.submit()


    })


  </script>
</body>

</html>